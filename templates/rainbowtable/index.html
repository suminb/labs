{% extends 'base.html' %}
{% block title %} Labs :: Rainbow Table {% endblock %}

{% block javascript %}
	<script type="text/javascript" src="/static/jquery.js"></script>
	<script type="text/javascript">
	function lookup() {
	    var panel = $('#result-panel');
	    var query = $('#query').attr('value');
	    panel.text('Searching...');
	    jQuery.getJSON('/rainbowtable/lookup?query=' + query, null, function(json) {
	    	panel.removeClass('hidden');
	        if(json.status == 'ok') {
	            panel.text(json.payload.type + ', ' + json.payload.plain);
	        }
	        else
	            panel.text(json.message);
	    });
	    return false;
	}
	
	function addEntry() {
	    var panel = $('#result-panel');
	    var plain = $('#plain').attr('value');
	
	    panel.text('')
	    jQuery.getJSON('/rainbowtable/add?plain=' + plain, null, function(json) {
	    	panel.removeClass('hidden');
	    	
	        var message = null;
	        if(json.status == 'ok') {
	            message = json.results.md5;
	            if(json.results.id != null) {
	                message += ' (' + json.results.id + ')';
	            }
	            $('#plain').attr('value', '');
	        }
	        else {
	            message = json.message;
	        }
	        $('#result-panel').text(message);
	    });
	
	    return false;
	}
	</script>
{% endblock %}


{% block content %}
<div class="notification">
    Due to integration with Google App Engine, this service is temporarily unavailable. We apologize for your inconvenience.
</div>

<h1>Rainbow Table (MD5, SHA1)</h1>

<p>
    A rainbow table is a lookup table offering a time-memory tradeoff used in recovering the plaintext password from a password hash generated by a hash function, often a cryptographic hash function. A common application is to make attacks against hashed passwords feasible. A salt is often employed with hashed passwords to make this attack more difficult, often infeasible.
    <sup class="footnote-ref"><a href="#fn-1">1</a></sup>
</p>

<p><a href="http://en.wikipedia.org/wiki/File:Rainbow_table2.svg" class="image"><img alt="Rainbow table2.svg" src="http://upload.wikimedia.org/wikipedia/commons/thumb/9/93/Rainbow_table2.svg/650px-Rainbow_table2.svg.png" width="650" height="267"></a></p>

<fieldset>
    <legend>Lookup / Add</legend>
    <form method="get" action="/rainbowtable/lookup" onsubmit="return lookup()">
    	<input type="text" id="query" name="query" style="width:240px;margin:4px;" disabled="disabled"/>
    	<input type="submit" value="Lookup" disabled="disabled"/>
    </form>
    <form method="get" action="/rainbowtable/add" onsubmit="return addEntry()">
    	<input type="text" id="plain" name="plain" style="width:240px;margin:4px;" disabled="disabled"/>
    	<input type="submit" value="Add" disabled="disabled"/>
    </form>

    <div id="result-panel" class="code hidden"></div>
    <!--<a href="/rainbowtable/recent">Recently added entries</a>-->
</fieldset>

<div class="footnotes">
    <hr/>
    <ol>
        <li id="fn-1">
            <a href="http://en.wikipedia.org/wiki/Rainbow_table">http://en.wikipedia.org/wiki/Rainbow_table</a>
            <span class="todo">(TODO: Needs to be in an MLA format)</span>
        </li>
    </ol>
</div>

{% endblock %}
